/******************** (C) COPYRIGHT 2013 STMicroelectronics ********************
* File Name          : main.c
* Author             : MSH Application Team
* Author             : Armando Visconti
* Revision           : $Revision: 1.2 $
* Date               : 09/2014
* Description        : EKSTM32 main file
* HISTORY:
* Date        | Modification                                | Author
* 08/2011     | Initial Revision                            | Armando Visconti
********************************************************************************
* THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
* WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE TIME.
* AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY DIRECT,
* INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING FROM THE
* CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE CODING
* INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.
*
* THIS SOFTWARE IS SPECIFICALLY DESIGNED FOR EXCLUSIVE USE WITH ST PARTS.
*******************************************************************************/

/* Includes ------------------------------------------------------------------*/

#include "stm32f10x.h"
#include "hw_config.h"
#include "i2C_mems.h"
#include "interruptHandler.h"
#include "LSM6DS3_ACC_GYRO_driver.h"

/* This macro can be used to switch on/off the evaluation with interrupts */
#define TEST_WITH_INTERRUPT     1

/* Private macro -------------------------------------------------------------*/

/* Private variables ---------------------------------------------------------*/
LSM6DS3_ACC_GYRO_GDA_t value_G;
float AngularRate_dps[3];

LSM6DS3_ACC_GYRO_XLDA_t value_XL;
float Acceleration_G[3];

Type3Axis16bit_U magneticField;
float magneticFieldGauss[3];

status_t response;  

/* LSM6DS3 device revision */
u8_t LSM6DS3_ACC_GYRO_Device_Rev = 0;

/* Extern variables ----------------------------------------------------------*/
/* Private function prototypes -----------------------------------------------*/

/* Private functions ---------------------------------------------------------*/

/*
 * This part is needed in case we need to bypass the device ROM 
 */

/* Code to put in RAM as provided by designers */
static uint8_t ram_code[LSM6DS3_ACC_GYRO_RAM_SIZE] = {
	0x54, 0x40, 0x10, 0x80, 0x43, 0x05, 0xAC, 0xFF, 0x2B, 0x58, 0x4D, 0x04, 0x34, 0x83, 0xD5, 0x2C,
	0x01, 0x2F, 0x1D, 0x40, 0xBD, 0x05, 0x04, 0x20, 0x48, 0x11, 0x50, 0x23, 0x00, 0xB3, 0x05, 0x2C,
	0xF7, 0xA0, 0x6C, 0x01, 0x8B, 0x2B, 0x30, 0x15, 0x10, 0x03, 0xC0, 0x50, 0x01, 0xBB, 0x26, 0x30,
	0x19, 0x00, 0x8B, 0x03, 0xEC, 0x1C, 0x30, 0x00, 0xD0, 0x72, 0x40, 0x80, 0x80, 0x04, 0x42, 0x35,
	0xDC, 0x40, 0xFC, 0x80, 0xC2, 0x0D, 0x2C, 0x00, 0xA8, 0x58, 0x40, 0x80, 0x80, 0xA4, 0x02, 0x35,
	0x02, 0xC0, 0x60, 0x01, 0xDB, 0x0F, 0x0A, 0x16, 0xB0, 0xDC, 0x40, 0xFC, 0x80, 0xC2, 0x0D, 0x2C,
	0xDC, 0x40, 0x00, 0x82, 0x74, 0x43, 0x35, 0xB9, 0x12, 0xE6, 0x4B, 0xA0, 0x33, 0x01, 0x08, 0x0C,
	0xDC, 0xC0, 0x02, 0x04, 0xD0, 0x1D, 0xAC, 0x77, 0xB0, 0xDF, 0xC1, 0x76, 0x03, 0x0D, 0x29, 0x04,
	0x7F, 0xA2, 0x00, 0x0E, 0x00, 0x32, 0x5D, 0x77, 0x11, 0xD1, 0x46, 0x80, 0x5C, 0x00, 0x88, 0x00,
	0x4B, 0x02, 0x83, 0x41, 0x00, 0x17, 0x01, 0x40, 0x01, 0xE4, 0x46, 0xC0, 0x5C, 0x00, 0x88, 0x00,
	0x4B, 0x02, 0x83, 0xC1, 0x68, 0x00, 0x20, 0x40, 0x80, 0x10, 0x1A, 0x74, 0x03, 0xEB, 0x5D, 0x04,
	0xD2, 0x46, 0x80, 0x5C, 0x00, 0x88, 0xC0, 0x92, 0xC0, 0x60, 0x10, 0xC0, 0x45, 0x00, 0x50, 0x00,
	0xE6, 0x46, 0xC0, 0x5C, 0x00, 0x88, 0xC0, 0x92, 0xC0, 0x60, 0x30, 0x1A, 0x00, 0x08, 0x10, 0x20,
	0x10, 0x1B, 0x78, 0x03, 0xFB, 0x5D, 0xC4, 0xB4, 0x11, 0x20, 0x17, 0x00, 0x22, 0xB0, 0x24, 0x30,
	0x60, 0x10, 0xC0, 0x45, 0x00, 0x50, 0x00, 0xBA, 0x11, 0x30, 0x17, 0x00, 0x22, 0xB0, 0x24, 0x30,
	0x60, 0x30, 0x1A, 0x00, 0x08, 0x10, 0x20, 0x04, 0x07, 0xDF, 0xC0, 0xF2, 0x2A, 0xDB, 0xBB, 0x2C,
	0xBE, 0xCC, 0xD2, 0x07, 0xCC, 0xAB, 0x44, 0xEF, 0x12, 0xBE, 0x4C, 0xFC, 0x26, 0x81, 0x1D, 0x04,
	0xB4, 0x49, 0xE9, 0x61, 0xDD, 0x0D, 0xB4, 0x4B, 0x52, 0x7D, 0x5C, 0x77, 0x03, 0xCD, 0x0D, 0x04,
	0x40, 0x20, 0x11, 0x52, 0x9D, 0x11, 0x54, 0x35, 0xD7, 0x01, 0x81, 0x75, 0x03, 0x2D, 0x39, 0x04,
	0x30, 0x51, 0x25, 0x72, 0x1D, 0x10, 0x58, 0x37, 0xD0, 0x00, 0x05, 0x50, 0x1B, 0x01, 0x7A, 0x01,
	0x80, 0x08, 0x2C, 0x09, 0x0C, 0x06, 0x01, 0x5C, 0x04, 0x00, 0x05, 0x54, 0x1B, 0x01, 0x7B, 0x01,
	0x80, 0x08, 0x2C, 0x09, 0x0C, 0x06, 0x23, 0x40, 0x01, 0xD6, 0x46, 0x00, 0x5F, 0x00, 0x88, 0x00,
	0x4B, 0x02, 0x83, 0xC1, 0x08, 0x18, 0x12, 0x28, 0xD4, 0x00, 0x00, 0x9C, 0x02, 0x6D, 0x00, 0x20,
	0x00, 0x01, 0x1A, 0x00, 0x08, 0x10, 0xA0, 0x01, 0x80, 0x00, 0x01, 0x42, 0x40, 0x70, 0x2D, 0x04,
	0x90, 0xF2, 0x1B, 0x08, 0x08, 0x30, 0xA0, 0x81, 0x80, 0x00, 0x03, 0x1A, 0x08, 0x08, 0x30, 0x20,
	0x00, 0x08, 0x80, 0x11, 0x40, 0x80, 0x94, 0x31, 0xD4, 0x40, 0x16, 0x00, 0xD1, 0x6F, 0x40, 0x20,
	0x00, 0xA5, 0x41, 0x51, 0x00, 0x43, 0xBF, 0x01, 0x81, 0x00, 0x05, 0x1A, 0x10, 0x08, 0x50, 0x20,
	0x06, 0x04, 0x02, 0x94, 0x06, 0x45, 0x01, 0x40, 0x01, 0x02, 0xE6, 0x03, 0xD9, 0x09, 0x46, 0x01,
	0x01, 0x88, 0xC5, 0x02, 0x0D, 0x04, 0xBF, 0x01, 0x80, 0x00, 0x01, 0x42, 0x40, 0x80, 0x1D, 0x04,
	0x91, 0x42, 0xFC, 0x89, 0x02, 0x02, 0x55, 0x37, 0xD7, 0x54, 0x43, 0x80, 0x0C, 0x43, 0x35, 0x2C,
	0xDF, 0xA3, 0x50, 0x0D, 0x6B, 0x0D, 0x34, 0x40, 0x00, 0xDC, 0x40, 0x00, 0x01, 0xC3, 0x0D, 0x2C,
	0xD4, 0xCA, 0x56, 0x2F, 0x6B, 0xCD, 0xEC, 0x75, 0xB2, 0xD8, 0xC1, 0x46, 0x2B, 0x2B, 0xBD, 0x2C,
	0xD3, 0xCC, 0x02, 0x80, 0x2A, 0x07, 0x04, 0x10, 0x48, 0xE8, 0x54, 0x67, 0x00, 0x11, 0x00, 0x12,
	0x00, 0xB0, 0x6E, 0x01, 0x01, 0x04, 0xD2, 0x3D, 0xD4, 0x04, 0xC0, 0x6C, 0x01, 0xBB, 0x0F, 0x0A,
	0x5B, 0xC0, 0x02, 0x00, 0xD0, 0x0C, 0x2C, 0x06, 0x00, 0xCE, 0xC0, 0x42, 0x00, 0x90, 0x0C, 0x2C,
	0xFF, 0x00, 0x08, 0x03, 0xBB, 0x05, 0x04, 0x08, 0x48, 0x03, 0x51, 0x0B, 0x00, 0xB3, 0x05, 0x2C,
	0xFD, 0xA0, 0x6C, 0x01, 0x0B, 0x00, 0xC0, 0x12, 0xB0, 0x4C, 0xC0, 0x6A, 0x03, 0xBB, 0x0D, 0x2C,
	0xE4, 0x4A, 0x98, 0x2F, 0x81, 0xCE, 0xC4, 0x23, 0x10, 0x80, 0x20, 0x31, 0x44, 0x5D, 0xAE, 0x04,
	0xE7, 0x4B, 0xA4, 0x33, 0xC1, 0xAB, 0x6C, 0xEF, 0xB2, 0xBE, 0xCC, 0xD2, 0x07, 0xFC, 0x0B, 0x04,
	0xC1, 0xC0, 0x0A, 0x07, 0xF1, 0x1F, 0xD4, 0x45, 0xD5, 0xC2, 0xC0, 0x02, 0x80, 0xFA, 0x2F, 0x00,
	0xC2, 0xC2, 0x42, 0x40, 0x86, 0x00, 0xE0, 0x23, 0x11, 0x40, 0x24, 0xC5, 0x54, 0x0D, 0x0C, 0x3E,
	0x10, 0x10, 0x0C, 0x07, 0x61, 0x2C, 0xC4, 0x30, 0xB0, 0x20, 0xD0, 0x21, 0x00, 0x48, 0x2C, 0x04,
	0xC5, 0x43, 0x10, 0x07, 0x5B, 0x2C, 0xAC, 0xF1, 0xB0, 0x30, 0xD1, 0x21, 0x04, 0x08, 0x31, 0x01,
	0x0A, 0x03, 0xC2, 0x44, 0x06, 0x01, 0x99, 0x54, 0xD0, 0xC7, 0x41, 0x28, 0x00, 0x08, 0x30, 0x01,
	0x10, 0x90, 0x01, 0x44, 0x00, 0x20, 0x81, 0x82, 0x80, 0x20, 0x15, 0x28, 0x08, 0x08, 0x12, 0x1D,
	0xC8, 0x42, 0x80, 0x44, 0x76, 0x1C, 0x2C, 0x40, 0x75, 0x30, 0xD5, 0x21, 0x17, 0x3B, 0x1C, 0x04,
	0xC4, 0x42, 0x14, 0x0F, 0xA1, 0x00, 0xE0, 0x30, 0xB0, 0xC4, 0xC1, 0x16, 0x0B, 0xAB, 0x20, 0x20,
	0x0A, 0x02, 0xC2, 0x44, 0xA6, 0x10, 0x20, 0x84, 0x74, 0x0A, 0x02, 0x1A, 0x07, 0x61, 0x3C, 0x2C,
	0x10, 0x90, 0x81, 0x40, 0xA6, 0x1C, 0xC4, 0xB2, 0x10, 0xCA, 0xC0, 0x2E, 0x07, 0x9B, 0xDC, 0x04,
	0xF0, 0x2D, 0x71, 0x45, 0x0D, 0xD1, 0x58, 0x72, 0xB3, 0x00, 0xA0, 0x3A, 0x0F, 0x41, 0x55, 0x04,
	0x8F, 0x44, 0x7C, 0x90, 0xE2, 0x30, 0xA0, 0xC3, 0x80, 0x10, 0x1E, 0x24, 0x07, 0x0C, 0xE3, 0x15,
	0xD0, 0x4C, 0x38, 0x0F, 0x41, 0xD7, 0x35, 0x70, 0x04, 0xF8, 0xA1, 0x20, 0x30, 0x46, 0x29, 0x04,
	0xF8, 0xA2, 0x80, 0x44, 0xA5, 0x9A, 0x35, 0x60, 0x00, 0xCC, 0xC1, 0x02, 0xB0, 0xB2, 0xDF, 0x0A,
	0xAA, 0x41, 0x1F, 0xB0, 0x02, 0x08, 0x0E, 0x60, 0x38, 0x80, 0xE2, 0x40, 0x40, 0xD5, 0xD7, 0x35,
	0x20, 0x51, 0xFD, 0x75, 0x6D, 0x1C, 0x34, 0x48, 0x54, 0xC6, 0x5D, 0x33, 0x3B, 0x01, 0xE8, 0x14,
	0x84, 0x55, 0x33, 0x07, 0x6B, 0x1C, 0x34, 0x84, 0x77, 0x88, 0x5D, 0xFF, 0xBB, 0x13, 0xE0, 0x18,
	0x30, 0x5E, 0xA9, 0x66, 0x4D, 0x09, 0xC4, 0x01, 0x28, 0x00, 0x5C, 0x41, 0x46, 0x1D, 0xC0, 0x18,
	0xA5, 0x41, 0x2F, 0x05, 0xC1, 0x24, 0x44, 0x00, 0x00, 0x04, 0x2D, 0x59, 0x56, 0x0D, 0x0C, 0x19,
	0x04, 0xCD, 0x00, 0x44, 0x06, 0x20, 0xDA, 0x66, 0xD7, 0x08, 0xC5, 0x00, 0x14, 0x83, 0xD0, 0x0C,
	0x4B, 0xC1, 0x32, 0x09, 0x0B, 0x04, 0x44, 0x50, 0x10, 0x42, 0x42, 0x20, 0x01, 0x9B, 0x14, 0x2C,
	0x4A, 0xC2, 0x02, 0x02, 0xC0, 0x0C, 0x2C, 0x38, 0x05, 0x20, 0x0E, 0xAC, 0x06, 0x0D, 0xE1, 0x00,
	0x41, 0x41, 0x40, 0x40, 0xF0, 0x2C, 0x04, 0x48, 0x74, 0x95, 0x42, 0x80, 0x44, 0x75, 0x9B, 0x35,
	0xCF, 0xC0, 0x22, 0xB4, 0x74, 0x1B, 0xF5, 0x7D, 0x2B, 0x10, 0xC5, 0x50, 0x15, 0x7B, 0x56, 0x0A,
	0x54, 0xC5, 0x36, 0x0B, 0x01, 0x41, 0x3E, 0x90, 0x8C, 0xCD, 0x40, 0x80, 0xC3, 0xEF, 0x4C, 0x04,
	0xE0, 0xF4, 0x43, 0x50, 0x06, 0x50, 0x1A, 0x90, 0x9C, 0xCD, 0xC2, 0x3A, 0x0F, 0x0B, 0xCD, 0x2C,
	0xC9, 0xCD, 0x02, 0x80, 0x0A, 0xE8, 0x12, 0x00, 0xAC, 0xFF, 0xEE, 0x04, 0x38, 0x06, 0x00, 0x2A,
	0x19, 0x40, 0x04, 0x80, 0x64, 0x5D, 0xF5, 0x12, 0x10, 0xDA, 0xC0, 0x32, 0x01, 0xB1, 0x0D, 0x2C,
	0x00, 0xA0, 0x62, 0x01, 0x01, 0x01, 0x92, 0x78, 0xD4, 0x04, 0xC0, 0x60, 0x01, 0xBB, 0x0F, 0x0A,
	0x58, 0xC0, 0x2E, 0x01, 0xA1, 0x0D, 0x2C, 0x13, 0x10, 0xDB, 0xC0, 0x02, 0x80, 0x3A, 0x49, 0x04,
	0x4B, 0x40, 0x30, 0x05, 0xA1, 0x2D, 0xC4, 0xF6, 0x10, 0x20, 0x70, 0x02, 0x41, 0x05, 0x80, 0x2B,
	0x54, 0x43, 0x00, 0x0D, 0x43, 0x35, 0xEC, 0xEF, 0x28, 0x54, 0xC3, 0x2E, 0x01, 0xC1, 0x14, 0x04,
	0xDA, 0xC0, 0x6E, 0x07, 0x0B, 0x00, 0x2A, 0x00, 0x00, 0xBC, 0x41, 0x00, 0x08, 0xD0, 0x3B, 0x04,
	0x00, 0x0B, 0xF8, 0x32, 0xE1, 0xAF, 0x8A, 0x42, 0x80, 0x08, 0x00, 0x2A, 0x0C, 0x88, 0x20, 0x20,
	0x80, 0x43, 0x11, 0x68, 0xFD, 0x3F, 0xCE, 0xBF, 0x38, 0x06, 0x42, 0xFF, 0x83, 0xF3, 0x1F, 0x0E,
	0x60, 0x08, 0x14, 0x24, 0x70, 0x86, 0x14, 0x88, 0xD4, 0x0A, 0xC0, 0x2E, 0x04, 0xDB, 0x80, 0x2C,
	0x0C, 0xC9, 0x1A, 0x10, 0x71, 0x50, 0x04, 0x10, 0x72, 0x0A, 0xC2, 0x2E, 0x0C, 0xDB, 0x80, 0x2C,
	0x0C, 0xC9, 0x1A, 0x18, 0x71, 0x70, 0x04, 0x60, 0x50, 0x1C, 0x5E, 0x03, 0xC9, 0x08, 0x06, 0x27,
	0x1E, 0x42, 0x03, 0xC9, 0x09, 0x06, 0x63, 0x10, 0x62, 0x08, 0x42, 0xDF, 0x01, 0xB0, 0x19, 0x00,
	0x34, 0x02, 0x07, 0xA8, 0xD4, 0x62, 0x35, 0x2C, 0x04, 0xC0, 0x11, 0x80, 0x49, 0x00, 0x37, 0x01,
	0x0A, 0x01, 0x22, 0x00, 0x18, 0xA0, 0x8C, 0x81, 0xD0, 0x06, 0x05, 0x02, 0x18, 0x08, 0x70, 0x20,
	0x06, 0x06, 0x02, 0x9C, 0xF6, 0x7B, 0x2C, 0x00, 0xA8, 0x00, 0x14, 0x00, 0x18, 0x00, 0x70, 0x00,
	0x20, 0xF4, 0x43, 0x60, 0x00, 0x82, 0x3F, 0x60, 0x65, 0x00, 0xA6, 0x41, 0x5A, 0x06, 0x70, 0x1A,
	0x00, 0x18, 0xC0, 0xE0, 0x0F, 0x58, 0x19, 0x80, 0x69, 0x00, 0xA7, 0x41, 0x5A, 0x06, 0x70, 0x1A,
	0x10, 0x18, 0xC0, 0xE0, 0x0F, 0x68, 0x19, 0xC0, 0x69, 0x90, 0x97, 0x01, 0x80, 0x0A, 0x87, 0x0B,
	0x4F, 0x52, 0xFF, 0x9F, 0x13, 0x70, 0x18, 0xA0, 0x49, 0x56, 0x52, 0xFF, 0x97, 0xF3, 0x6F, 0x0E,
	0x01, 0x85, 0x01, 0x98, 0x06, 0x88, 0x8E, 0xF8, 0xB1, 0x70, 0xF6, 0x83, 0x1B, 0x1B, 0x7E, 0x2C,
	0xE2, 0x46, 0x40, 0xD9, 0x0F, 0x56, 0x01, 0x9C, 0x05, 0xE0, 0x47, 0xC0, 0x59, 0x16, 0x7E, 0x04,
	0x00, 0xA7, 0x01, 0xA2, 0xA4, 0x26, 0xF5, 0x7F, 0x39, 0xFF, 0xE6, 0xFC, 0x9F, 0x13, 0x50, 0x18,
	0x00, 0xA6, 0x01, 0x9C, 0x06, 0x00, 0x2A, 0x04, 0x10, 0x0C, 0xA0, 0xA0, 0x04, 0x40, 0x5E, 0x00,
	0x2D, 0x41, 0x01, 0xF0, 0x0A, 0x21, 0x45, 0x40, 0x60, 0x10, 0x53, 0xC0, 0x50, 0xC0, 0x27, 0x30,
	0x50, 0xD3, 0x06, 0x14, 0x06, 0x45, 0x6D, 0x40, 0x60, 0x01, 0x85, 0xBD, 0x09, 0x0D, 0x00, 0x14,
	0x80, 0x56, 0x2B, 0x10, 0x08, 0x00, 0x2A, 0xA4, 0xC0, 0x06, 0x02, 0x02, 0x0C, 0x88, 0x00, 0x14,
	0x00, 0xB0, 0xC2, 0x50, 0x00, 0x29, 0xB0, 0x81, 0x80, 0x00, 0x03, 0x32, 0x00, 0x05, 0x00, 0x2B,
	0x30, 0x14, 0x40, 0x0A, 0x6C, 0x20, 0x20, 0xC0, 0x80, 0x00, 0xA0, 0x02, 0x0D, 0x05, 0x80, 0x2B,
	0x80, 0x43, 0x5D, 0x7A, 0xFD, 0x2F, 0xC0, 0xCF, 0x00, 0x00, 0xA0, 0x02, 0x0F, 0xB5, 0xE9, 0x35,
	0x00, 0x02, 0x00, 0x0F, 0x00, 0x00, 0x2A, 0x00, 0x00, 0x82, 0x01, 0x00, 0x07, 0x35, 0x2A, 0x35,
	0x10, 0xD0, 0x06, 0x04, 0xE6, 0x29, 0xF4, 0x50, 0x00, 0x5A, 0x41, 0xA5, 0x4A, 0x0D, 0x01, 0x2D,
	0x01, 0x81, 0x91, 0x0A, 0xBD, 0x05, 0x2C, 0x04, 0x00, 0x8F, 0xC0, 0xBA, 0x01, 0x40, 0x09, 0x2C,
	0x7A, 0x00, 0x40, 0x02, 0x9B, 0x06, 0x40, 0x24, 0xB0, 0x32, 0x00, 0x48, 0x02, 0x6B, 0x00, 0x00,
	0x93, 0xC0, 0xE2, 0x0A, 0x0C, 0x00, 0x2A, 0x00, 0x00, 0xC0, 0x01, 0x3C, 0x04, 0xF5, 0x2B, 0x35,
	0x10, 0xD0, 0x06, 0x04, 0xA6, 0x2B, 0x34, 0x20, 0x00, 0xCC, 0xC0, 0x02, 0x00, 0xD0, 0x0C, 0x2C,
	0x18, 0x00, 0x38, 0x03, 0x0B, 0x01, 0x40, 0x32, 0xB0, 0xFF, 0x00, 0x08, 0x03, 0xAB, 0x07, 0x00,
	0xFE, 0xC0, 0xF6, 0x00, 0xF0, 0x0F, 0x2C, 0x00, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x30, 0x00,
	0x00, 0x04, 0x00, 0x14, 0x00, 0x60, 0x00, 0xC0, 0x01, 0x00, 0x08, 0x00, 0x24, 0x00, 0xA0, 0x00,
	0x00, 0x0B, 0x00, 0x30, 0x00, 0xD0, 0x00, 0x80, 0x03, 0x00, 0x0F, 0x20, 0x00, 0x80, 0x00, 0x00,
	0xA4, 0xC0, 0xA2, 0x02, 0xCB, 0x0A, 0x2C, 0x00, 0xA8, 0x01, 0xCF, 0xF8, 0xB7, 0x82, 0xD5, 0x2C,
	0x01, 0x80, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x2E, 0x34,
	0x54, 0x40, 0x10, 0x80, 0x43, 0x05, 0x2C, 0x00, 0x00, 0x18, 0x4E, 0x10, 0xB8, 0x04, 0x00, 0x35,
	0x2E, 0x09, 0x40, 0x6A, 0x31, 0xBB, 0x00, 0xAC, 0xB6, 0x01, 0x8B, 0x05, 0x24, 0x06, 0xA9, 0x05,
	0xB0, 0xDA, 0x06, 0x2C, 0x16, 0x90, 0x18, 0xA4, 0x16, 0xB0, 0xDA, 0x06, 0x2C, 0x16, 0x90, 0x18,
	0x90, 0x5A, 0xC0, 0x6A, 0x1B, 0xB0, 0x58, 0x40, 0x62, 0x90, 0x5A, 0xC0, 0x6A, 0x1B, 0xB0, 0x18,
	0x01, 0x89, 0x41, 0x6A, 0x01, 0xAB, 0xED, 0x6C, 0x02, 0xB4, 0x0A, 0xB4, 0x02, 0xE0, 0x2A, 0x00,
	0xF0, 0xC0, 0xC6, 0x0B, 0x0B, 0x0C, 0xF0, 0x6C, 0x02, 0xB4, 0x0A, 0xF0, 0x04, 0xDC, 0x17, 0x30,
	0xB5, 0x09, 0xD8, 0x2A, 0x00, 0x0C, 0x30, 0x4F, 0xC0, 0x7D, 0x01, 0xDF, 0x26, 0x80, 0xAB, 0x00,
	0xC0, 0x00, 0xF3, 0x04, 0x3C, 0x9B, 0x00, 0xAD, 0x02, 0xA4, 0x0B, 0x84, 0x02, 0x2C, 0x6F, 0x2C,
	0xF3, 0xC7, 0xB6, 0x02, 0xE0, 0x2A, 0x00, 0x40, 0x14, 0x20, 0x53, 0xC8, 0x1B, 0x31, 0x7F, 0x04,
	0x0D, 0x01, 0x37, 0x25, 0xE0, 0xA4, 0x00, 0x24, 0xB4, 0xA0, 0xD2, 0xCE, 0x26, 0x40, 0xAB, 0x00,
	0xA7, 0x0B, 0x84, 0x02, 0x5C, 0x9B, 0x80, 0xAD, 0x02, 0xF4, 0xC6, 0xD6, 0x1F, 0xFB, 0x0A, 0x00,
	0xB0, 0x02, 0x00, 0x44, 0x01, 0x32, 0x05, 0xBD, 0x11, 0xF5, 0x47, 0x34, 0x04, 0xFC, 0x94, 0x00,
	0x50, 0x0A, 0x40, 0x42, 0x0B, 0x2A, 0xED, 0x6C, 0x02, 0xB4, 0x0A, 0xA8, 0x2E, 0x10, 0x0A, 0x30,
	0xB7, 0x09, 0xE0, 0x2A, 0x60, 0x6F, 0xEC, 0xFD, 0xB1, 0xB1, 0x00, 0xC8, 0x0A, 0x00, 0x10, 0x05,
	0x20, 0x53, 0xD8, 0x1B, 0x71, 0x7F, 0x44, 0x43, 0xC0, 0x51, 0x09, 0x48, 0x29, 0x00, 0x09, 0x2D,
	0xA0, 0xD2, 0xCA, 0x1B, 0x31, 0x7F, 0x04, 0x4D, 0x02, 0x35, 0x0A, 0x40, 0x5A, 0x0B, 0x7A, 0x2D,
	0xF4, 0x46, 0xD4, 0x1F, 0x21, 0x90, 0x98, 0x80, 0x62, 0x90, 0xD6, 0x82, 0x5E, 0x6B, 0x6F, 0x04,
	0xF7, 0x47, 0x08, 0x24, 0x26, 0xA0, 0x18, 0xA4, 0xB5, 0xA0, 0xD7, 0x56, 0x0D, 0x21, 0x30, 0x0C,
	0x55, 0xC3, 0xF6, 0x8F, 0x52, 0x35, 0x2C, 0x00, 0xD0, 0x98, 0x00, 0xC3, 0x03, 0x21, 0x00, 0x18,
	0xF0, 0xC0, 0xC6, 0x0B, 0x21, 0x20, 0x58, 0xBC, 0xB0, 0xB5, 0x09, 0xD8, 0x2A, 0x70, 0xBA, 0x00,
	0x98, 0x00, 0xC3, 0x03, 0x21, 0x00, 0x18, 0x3C, 0xB0, 0xF1, 0x42, 0x08, 0x08, 0x16, 0x2F, 0x2C,
	0xB7, 0x09, 0xE0, 0x2A, 0xA0, 0xBA, 0x00, 0x26, 0xC0, 0x00, 0x40, 0x03, 0x03, 0x3C, 0x5B, 0x04,
	0x01, 0x25, 0x85, 0x42, 0xCD, 0x13, 0xF0, 0x6C, 0x10, 0x02, 0x21, 0x01, 0x00, 0x1D, 0x0A, 0x30,
	0x00, 0x0F, 0x00, 0x04, 0x00, 0x30, 0x00, 0x40, 0x01, 0x00, 0x06, 0x00, 0x1C, 0x00, 0x80, 0x00,
	0x00, 0x4F, 0xC1, 0x42, 0x1D, 0xF0, 0xD4, 0x2C, 0xD4, 0x02, 0x4F, 0xED, 0x42, 0x3D, 0xF0, 0x14,
	0xF1, 0x50, 0x1F, 0x03, 0x0C, 0x4B, 0x85, 0x32, 0xD0, 0xA0, 0x52, 0x80, 0xD4, 0x03, 0xC5, 0x01,
	0x02, 0x89, 0x09, 0x28, 0x76, 0x0C, 0x30, 0x2C, 0x15, 0xCA, 0x40, 0x0B, 0x24, 0x26, 0xA0, 0x18,
	0xC7, 0x00, 0xC3, 0x52, 0xA1, 0x0C, 0x34, 0x3C, 0x10, 0x00, 0x51, 0xC4, 0x0B, 0x01, 0x32, 0x05,
	0x90, 0x50, 0x80, 0x4A, 0x01, 0x00, 0x2A, 0x24, 0x14, 0xA0, 0x52, 0x00, 0x80, 0x8A, 0x11, 0x34,
	0x01, 0x8B, 0x05, 0x3C, 0x06, 0x2A, 0x05, 0x94, 0x3C, 0x20, 0x14, 0x00, 0xCB, 0x03, 0x28, 0x12,
	0xE2, 0x50, 0x03, 0x4E, 0x75, 0x0D, 0x75, 0x39, 0xD6, 0xE9, 0x5C, 0xC3, 0x45, 0xB5, 0x0D, 0x35,
	0xE5, 0x58, 0xA7, 0x73, 0x0D, 0x06, 0x55, 0x39, 0xD6, 0xE9, 0x5C, 0x83, 0x4A, 0x01, 0x25, 0x0F,
	0x80, 0x22, 0x95, 0x53, 0x0D, 0x60, 0x23, 0x0C, 0x6E, 0xA8, 0x40, 0x03, 0x58, 0x07, 0x71, 0x1F,
	0x30, 0xF8, 0xA1, 0x02, 0x0D, 0x06, 0x1D, 0x5C, 0x7C, 0x80, 0xF3, 0x01, 0x71, 0x00, 0x60, 0x01,
	0x10, 0x17, 0xC0, 0x60, 0x80, 0x0A, 0x34, 0x20, 0x4B, 0x32, 0x15, 0x53, 0x04, 0x4C, 0x11, 0x30,
	0x14, 0x01, 0xE3, 0x23, 0x0B, 0x87, 0x0F, 0x20, 0x4A, 0x04, 0x51, 0x03, 0x9E, 0xE4, 0x4F, 0x35,
	0x01, 0x51, 0x03, 0x80, 0xFA, 0x77, 0xC0, 0xBF, 0x01, 0x00, 0xA0, 0x02, 0x1E, 0x00, 0x60, 0x00,
	0x00, 0xA0, 0xE2, 0x27, 0x00, 0x89, 0x05, 0x00, 0x52, 0x00, 0xB0, 0xFE, 0x23, 0x05, 0x00, 0x2B,
	0x80, 0x28, 0xF9, 0x43, 0x1D, 0x50, 0x35, 0x5D, 0xC0, 0x60, 0x10, 0xC0, 0x49, 0x60, 0x96, 0x1C,
	0x66, 0xCA, 0xF1, 0x04, 0x0C, 0x00, 0xAA, 0x02, 0x82, 0x08, 0x07, 0x22, 0x18, 0x08, 0x00, 0x2A,
	0x40, 0x15, 0x00, 0x8A, 0x94, 0x12, 0x35, 0x47, 0xD0, 0x80, 0x42, 0x7D, 0x44, 0x1D, 0x52, 0x35,
	0x00, 0x40, 0x95, 0x44, 0x1D, 0x00, 0x1C, 0x80, 0x78, 0xFF, 0xE0, 0xFC, 0x8B, 0xD3, 0x12, 0x30,
	0x39, 0x01, 0x03, 0x96, 0xC4, 0x12, 0x74, 0x4B, 0xC0, 0x39, 0x01, 0x03, 0x96, 0xB4, 0x0C, 0x34,
	0x7F, 0xA4, 0x00, 0xC1, 0x0F, 0x24, 0x3F, 0x00, 0xA8, 0x00, 0xA0, 0xFE, 0x9B, 0xF3, 0x7F, 0x0E,
	0xFF, 0xE8, 0x04, 0x18, 0x06, 0x70, 0x1A, 0x00, 0x6A, 0x00, 0xA0, 0x82, 0x44, 0x06, 0x30, 0x1A,
	0x00, 0xA0, 0x82, 0x50, 0x00, 0x53, 0x01, 0xA0, 0x48, 0x6F, 0x15, 0x03, 0x8E, 0x44, 0x57, 0x31,
	0x40, 0xF5, 0x00, 0x96, 0x24, 0x15, 0xB5, 0x51, 0xD5, 0x10, 0x90, 0xC1, 0xC8, 0xC6, 0xD4, 0x35,
	0x4A, 0x59, 0xFF, 0x09, 0xF0, 0x0F, 0x00, 0xA0, 0x50, 0x4A, 0x51, 0x2B, 0x75, 0x0D, 0x48, 0x12,
	0x61, 0x55, 0xE7, 0x45, 0x3D, 0x15, 0x34, 0x8C, 0x54, 0x56, 0x59, 0x77, 0x75, 0x0D, 0x10, 0x1D,
	0x20, 0xF3, 0x41, 0x40, 0x00, 0x23, 0x01, 0x20, 0x49, 0x61, 0x51, 0xE7, 0x05, 0x0D, 0x01, 0x1D,
	0x30, 0xF2, 0x01, 0x92, 0x94, 0x17, 0xF5, 0x9F, 0x50, 0x64, 0x51, 0xAB, 0x55, 0xFD, 0x0F, 0x14,
	0x67, 0x51, 0xAB, 0x55, 0x0D, 0x00, 0x00, 0xA0, 0x00, 0x79, 0x41, 0xFF, 0x83, 0xF3, 0x2F, 0x0E,
	0x01, 0x80, 0x01, 0x88, 0x96, 0x17, 0x74, 0x00, 0x70, 0x00, 0xE2, 0xFD, 0x83, 0xF3, 0x2F, 0x0E,
	0x00, 0xA0, 0x06, 0x04, 0x07, 0x30, 0xDE, 0x7F, 0x38, 0xFF, 0xE3, 0x00, 0x80, 0x0A, 0x09, 0x2D,
	0xA0, 0xD2, 0x02, 0x80, 0x0A, 0x00, 0x2A, 0x3C, 0x10, 0x02, 0x80, 0xC1, 0x03, 0x1B, 0x2F, 0x04,
	0x02, 0x82, 0xC5, 0x0B, 0x0B, 0x00, 0x6A, 0xC0, 0x03, 0x02, 0xCF, 0x58, 0x3D, 0x0B, 0x00, 0x2A,
	0xB5, 0x01, 0xB3, 0x06, 0x2C, 0x1B, 0x70, 0x6A, 0xC0, 0x00, 0xA0, 0xCA, 0x06, 0xCC, 0x1A, 0x30,
	0xB5, 0x01, 0x03, 0x80, 0x0A, 0x18, 0x00, 0x44, 0x4D, 0x96, 0x55, 0xCB, 0x06, 0x7C, 0x19, 0x34,
	0xB5, 0x01, 0x87, 0x06, 0xEC, 0x10, 0x20, 0x00, 0xAE, 0x92, 0x41, 0x23, 0x04, 0x80, 0x1B, 0x30,
	0x01, 0xC1, 0x71, 0x56, 0x0D, 0x00, 0xAA, 0x6C, 0xC0, 0xAC, 0x01, 0xA7, 0x06, 0x0C, 0x00, 0x2A,
	0xB5, 0x01, 0x87, 0x06, 0x8D, 0x1B, 0x70, 0x40, 0x49, 0x00, 0xA0, 0xFA, 0xBF, 0x62, 0xF5, 0x2C,
	0x00, 0xA0, 0x06, 0x3C, 0x63, 0xF5, 0xEC, 0x15, 0x10, 0x01, 0x20, 0xB9, 0x46, 0x0D, 0x00, 0x2A,
	0xFD, 0xAF, 0x58, 0x3D, 0x0B, 0x00, 0xAA, 0xC0, 0x33, 0x56, 0xCF, 0x02, 0x80, 0x5A, 0x1B, 0x30,
	0xAC, 0x01, 0x5F, 0x01, 0x21, 0x00, 0x12, 0x40, 0x81, 0xA9, 0x01, 0x03, 0x80, 0x4A, 0x1C, 0x30,
	0xC4, 0x01, 0x13, 0x07, 0x4C, 0x1C, 0x30, 0x00, 0xA8, 0x01, 0x00, 0x00, 0x80, 0x0A, 0xE0, 0x14,
	0xCE, 0x51, 0x43, 0x38, 0x05, 0x1D, 0x35, 0x88, 0x53, 0xD2, 0x51, 0xC3, 0x38, 0x45, 0x1D, 0x35,
	0x01, 0x0E, 0x00, 0x80, 0x2A, 0xE0, 0x00, 0x00, 0xA8, 0x03, 0x0E, 0x00, 0x80, 0x4A, 0xE0, 0x00,
	0x00, 0xA0, 0x02, 0x00, 0x20, 0x18, 0x00, 0x70, 0x50, 0xDD, 0x51, 0x43, 0x40, 0x1B, 0x10, 0x18,
	0xD8, 0x41, 0x0F, 0x05, 0xA0, 0x15, 0xD4, 0x78, 0xD4, 0x10, 0xD0, 0x06, 0x04, 0xE6, 0x1D, 0x34,
	0x5B, 0xC0, 0x1E, 0x00, 0xF0, 0x08, 0xAC, 0x1E, 0x00, 0x90, 0xC0, 0xA6, 0x01, 0x10, 0x09, 0x2C,
	0x32, 0x00, 0x48, 0x02, 0x6B, 0x00, 0xC0, 0x24, 0xB0, 0x08, 0x00, 0x90, 0x02, 0x8B, 0x0A, 0x2C,
	0xAC, 0xC0, 0xD2, 0x07, 0x0C, 0x00, 0x2A, 0x00, 0x00, 0xC0, 0x01, 0x3C, 0x04, 0xB5, 0x1F, 0x35,
	0x10, 0xD0, 0x06, 0x04, 0x66, 0x1F, 0x34, 0x09, 0x00, 0xCD, 0xC0, 0x42, 0x00, 0x90, 0x0C, 0x2C,
	0xFF, 0x00, 0x08, 0x03, 0xAB, 0x07, 0x80, 0x3F, 0xB0, 0x3D, 0x00, 0xFC, 0x03, 0x0B, 0x00, 0x00,
	0x00, 0x01, 0x00, 0x08, 0x00, 0x30, 0x00, 0x00, 0x01, 0x00, 0x05, 0x00, 0x18, 0x00, 0x70, 0x00,
	0x00, 0x08, 0x00, 0x24, 0x00, 0xA0, 0x00, 0xC0, 0x02, 0x00, 0x0C, 0x00, 0x34, 0x00, 0xE0, 0x00,
	0x00, 0x0F, 0x00, 0x80, 0x1A, 0xF0, 0x8C, 0x7F, 0x2B, 0x58, 0xCD, 0x06, 0x00, 0x0E, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x21, 0x34
        };

u8_t XL_samples[6];
u8_t G_samples[6];

/*
 * ACC + Gyro test
 */

/*
 * Callback to handle the XL and Gyro event.
 * It must be registered to be called at interrupt time.
 */
void LSM6DS3_ACC_GYRO_sample_Callback(u8_t intID)
{
  LSM6DS3_ACC_GYRO_XLDA_t event_XL;
  LSM6DS3_ACC_GYRO_GDA_t event_G;

  /*
   * Read ACC output only if new ACC value is available
   */
  LSM6DS3_ACC_GYRO_R_XLDA(&event_XL);
  if (LSM6DS3_ACC_GYRO_XLDA_DATA_AVAIL==event_XL) {
      LSM6DS3_ACC_Get_Acceleration(Acceleration_G);
  }

  /*
   * Read ACC output only if new ACC value is available
   */
  LSM6DS3_ACC_GYRO_R_GDA(&event_G);
  if (LSM6DS3_ACC_GYRO_GDA_DATA_AVAIL==event_G) {
    LSM6DS3_ACC_Get_AngularRate(AngularRate_dps);
  }
}

/* Init the Gyroscope */
static void init_LSM6DS3_GYRO(void)
{
  /* Gyro ODR and full scale */
  response = LSM6DS3_ACC_GYRO_W_ODR_G(LSM6DS3_ACC_GYRO_ODR_G_104Hz);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  response = LSM6DS3_ACC_GYRO_W_FS_G(LSM6DS3_ACC_GYRO_FS_G_2000dps);
  if(response==MEMS_ERROR) while(1); //manage here comunication error
}

/* Init the Accelerometer */
static void init_LSM6DS3_ACC(void)
{
  /* Set ACC ODR  */
  response = LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_104Hz);
  if(response==MEMS_ERROR) while(1); //manage here comunication error
  
  /* Set ACC full scale */
  response = LSM6DS3_ACC_GYRO_W_FS_XL(LSM6DS3_ACC_GYRO_FS_XL_8g);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* BDU Enable */
  response = LSM6DS3_ACC_GYRO_W_BDU(LSM6DS3_ACC_GYRO_BDU_BLOCK_UPDATE);
  if(response==MEMS_ERROR) while(1); //manage here comunication error
}

/* Test Acquisition of sensor samples */
static  void Loop_Test_Sample_Aquisition(void)
{
  /* configure device */
  init_LSM6DS3_GYRO();
  init_LSM6DS3_ACC();

#ifdef TEST_WITH_INTERRUPT
  /* Config XL interrupt (Gyro samples will be acquired @ XL ODR) */
  RegisterInterrupt(LSM6DS3_ACC_GYRO_sample_Callback);
  LSM6DS3_ACC_GYRO_W_DRDY_XL_on_INT1(LSM6DS3_ACC_GYRO_INT1_DRDY_XL_ENABLED);
  //LSM6DS3_ACC_GYRO_W_DRDY_G_on_INT1(LSM6DS3_ACC_GYRO_INT1_DRDY_G_ENABLED);

  while(1) {
    /* Event will be handled in driver callback */
  }
#else
  /*
   * Read samples in polling mode (no int)
   */
  while(1)
  {
    /*
     * Read ACC output only if new ACC value is available
     */
    response =  LSM6DS3_ACC_GYRO_R_XLDA(&value_XL);
    if(response==MEMS_ERROR) while(1); //manage here comunication error  
    
    if (LSM6DS3_ACC_GYRO_XLDA_DATA_AVAIL==value_XL)
    {
      LSM6DS3_ACC_Get_Acceleration(Acceleration_G);
    }

    /* 
     * Read GYRO output only if new gyro value is available
     */
    response =  LSM6DS3_ACC_GYRO_R_GDA(&value_G);
    if(response==MEMS_ERROR) while(1); //manage here comunication error  
    
    if (LSM6DS3_ACC_GYRO_GDA_DATA_AVAIL==value_G)
    {
      LSM6DS3_ACC_Get_AngularRate(AngularRate_dps);
    }
  }
#endif
}

/*
 * PEDOMETER test
 */
u16_t Number_Of_Steps = 0;

/*
 * Callback to handle the Pedometer event.
 * It must be registered to be called at interrupt time.
 */
void LSM6DS3_ACC_GYRO_Pedo_Callback(u8_t intID)
{
  LSM6DS3_ACC_GYRO_PEDO_EV_STATUS_t PedoStatus;

  LSM6DS3_ACC_GYRO_R_PEDO_EV_STATUS(&PedoStatus);
  if (PedoStatus == LSM6DS3_ACC_GYRO_PEDO_EV_STATUS_DETECTED) {
    LSM6DS3_ACC_GYRO_Get_GetStepCounter((u8_t *)&Number_Of_Steps);
  }
}

/* Init the Pedometer */
static void init_LSM6DS3_Pedometer(void)
{
  /* Set ACC ODR  */
  response = LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_26Hz);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Enable Pedometer  */
  response = LSM6DS3_ACC_GYRO_W_PEDO_EN(LSM6DS3_ACC_GYRO_PEDO_EN_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Pedometer on INT1 */
  response = LSM6DS3_ACC_GYRO_W_PEDO_STEP_on_INT1(LSM6DS3_ACC_GYRO_INT1_PEDO_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Clear INT1 routing */
  LSM6DS3_ACC_GYRO_WriteReg(LSM6DS3_ACC_GYRO_MD1_CFG, 0x0);

  /* Enable Embedded Functions */
  LSM6DS3_ACC_GYRO_W_FUNC_EN(LSM6DS3_ACC_GYRO_FUNC_EN_ENABLED);
}

/* Test pedometer */
static void  Loop_Test_Pedometer(void)
{
  /* configure pedometer */
  init_LSM6DS3_Pedometer();

  /* configure pedometer acceleration threshold */
  LSM6DS3_ACC_GYRO_W_PedoThreshold(13);

  /* Clear the step counter */
  LSM6DS3_ACC_GYRO_W_PedoStepReset(LSM6DS3_ACC_GYRO_PEDO_RST_STEP_ENABLED);

#ifdef TEST_WITH_INTERRUPT
  RegisterInterrupt(LSM6DS3_ACC_GYRO_Pedo_Callback);

  while(1) {
    /* Event will be handled in driver callback */
  }
#else
  LSM6DS3_ACC_GYRO_PEDO_EV_STATUS_t PedoStatus;

  /*
   * Handle the event using polling mode
   */
  while(1) {
    LSM6DS3_ACC_GYRO_R_PEDO_EV_STATUS(&PedoStatus);
    if (PedoStatus == LSM6DS3_ACC_GYRO_PEDO_EV_STATUS_DETECTED) {
      LSM6DS3_ACC_GYRO_Get_GetStepCounter((u8_t *)&Number_Of_Steps);
    }
  }
#endif
}

/*
 * Wakeup test
 */
u16_t Number_Of_Wakeup_events = 0;

/*
 * Callback to handle the Wakeup event.
 * It must be registered to be called at interrupt time.
 */
void LSM6DS3_ACC_GYRO_Wakeup_Callback(u8_t intID)
{
  LSM6DS3_ACC_GYRO_WU_EV_STATUS_t WakeupStatus;

  LSM6DS3_ACC_GYRO_R_WU_EV_STATUS(&WakeupStatus);
  if (WakeupStatus == LSM6DS3_ACC_GYRO_WU_EV_STATUS_DETECTED) {
    Number_Of_Wakeup_events++;

    /* handle event */
    WakeupStatus = LSM6DS3_ACC_GYRO_WU_EV_STATUS_NOT_DETECTED;
  }
}

/* Init the Wakeup */
static void init_LSM6DS3_Wakeup(void)
{
  /* Set ACC ODR  */
  response = LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_104Hz);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Set Wakeup threshold  */
  response = LSM6DS3_ACC_GYRO_W_WK_THS(2);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Set Wakeup duration  */
  response = LSM6DS3_ACC_GYRO_W_SLEEP_DUR(0);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Wakeup on INT1 */
  response = LSM6DS3_ACC_GYRO_W_WUEvOnInt1(LSM6DS3_ACC_GYRO_INT1_WU_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error
}

/* Test Wakeup */
static void  Loop_Test_Wakeup(void)
{
  Number_Of_Wakeup_events = 0;

  /* configure pedometer */
  init_LSM6DS3_Wakeup();

#ifdef TEST_WITH_INTERRUPT
  RegisterInterrupt(LSM6DS3_ACC_GYRO_Wakeup_Callback);

  while(1) {
    /* Event will be handled in driver callback */
  }
#else
  LSM6DS3_ACC_GYRO_WU_EV_STATUS_t WakeupStatus;

  /*
   * Handle the event using polling mode
   */
  while(1) {
    LSM6DS3_ACC_GYRO_R_WU_EV_STATUS(&WakeupStatus);
    if (WakeupStatus == LSM6DS3_ACC_GYRO_WU_EV_STATUS_DETECTED) {
      Number_Of_Wakeup_events++;

      /* handle event */
      WakeupStatus = LSM6DS3_ACC_GYRO_WU_EV_STATUS_NOT_DETECTED;
    }
  }
#endif
}

/*
 * Tilt test
 */
u16_t Number_Of_Tilt_events = 0;

/*
 * Callback to handle the Tilt event.
 * It must be registered to be called at interrupt time.
 */
void LSM6DS3_ACC_GYRO_Tilt_Callback(u8_t intID)
{
  LSM6DS3_ACC_GYRO_TILT_EV_STATUS_t TiltStatus;

  LSM6DS3_ACC_GYRO_R_TILT_EV_STATUS(&TiltStatus);
  if (TiltStatus == LSM6DS3_ACC_GYRO_TILT_EV_STATUS_DETECTED) {
    Number_Of_Tilt_events++;

    /* handle event */
    TiltStatus = LSM6DS3_ACC_GYRO_TILT_EV_STATUS_NOT_DETECTED;
  }
}

/* Init the Tilt */
static void init_LSM6DS3_Tilt(void)
{
  /* Set ACC ODR  */
  response = LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_26Hz);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Enable Tilt  */
  response = LSM6DS3_ACC_GYRO_W_TILT_EN(LSM6DS3_ACC_GYRO_TILT_EN_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Clear INT1 routing */
  LSM6DS3_ACC_GYRO_WriteReg(LSM6DS3_ACC_GYRO_INT1_CTRL, 0x0);

  /* Tilt on INT1 */
  response = LSM6DS3_ACC_GYRO_W_TiltEvOnInt1(LSM6DS3_ACC_GYRO_INT1_TILT_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Enable Embedded Functions */
  LSM6DS3_ACC_GYRO_W_FUNC_EN(LSM6DS3_ACC_GYRO_FUNC_EN_ENABLED);
}

/* Test Tilt */
static void  Loop_Test_Tilt(void)
{
  Number_Of_Tilt_events = 0;

  /* configure Tilt */
  init_LSM6DS3_Tilt();
  
#ifdef TEST_WITH_INTERRUPT
  RegisterInterrupt(LSM6DS3_ACC_GYRO_Tilt_Callback);

  while(1) {
    /* Event will be handled in driver callback */
  }
#else
  LSM6DS3_ACC_GYRO_TILT_EV_STATUS_t TiltStatus;

  /*
   * Handle the event using polling mode
   */
  while(1) {
    LSM6DS3_ACC_GYRO_R_TILT_EV_STATUS(&TiltStatus);
    if (TiltStatus == LSM6DS3_ACC_GYRO_TILT_EV_STATUS_DETECTED) {
      Number_Of_Tilt_events++;

      /* handle event */
      TiltStatus = LSM6DS3_ACC_GYRO_TILT_EV_STATUS_NOT_DETECTED;
    }
  }
#endif
}

/*
 * Significant Motion test
 */
u16_t Number_Of_SigMot_events = 0;

/*
 * Callback to handle the SigMotion event.
 * It must be registered to be called at interrupt time.
 */
void LSM6DS3_ACC_GYRO_SigMotion_Callback(u8_t intID)
{
  LSM6DS3_ACC_GYRO_SIGN_MOT_EV_STATUS_t SigMotStatus;

  LSM6DS3_ACC_GYRO_R_SIGN_MOT_EV_STATUS(&SigMotStatus);
  if (SigMotStatus == LSM6DS3_ACC_GYRO_SIGN_MOT_EV_STATUS_DETECTED) {
    Number_Of_SigMot_events++;

    /* handle event */
    SigMotStatus = LSM6DS3_ACC_GYRO_SIGN_MOT_EV_STATUS_NOT_DETECTED;
  }
}

/* Init the SigMotion */
static void init_LSM6DS3_SigMotion(void)
{
  /* Set ACC ODR  */
  response = LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_26Hz);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Enable Pedometer  - This is a workaround to an issue that will be corrected later on */
  response = LSM6DS3_ACC_GYRO_W_PEDO_EN(LSM6DS3_ACC_GYRO_PEDO_EN_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* SigMotion on INT1 */
  response = LSM6DS3_ACC_GYRO_W_SIGN_MOT_on_INT1(LSM6DS3_ACC_GYRO_INT1_SIGN_MOT_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Clear INT1 routing */
  LSM6DS3_ACC_GYRO_WriteReg(LSM6DS3_ACC_GYRO_MD1_CFG, 0x0);

  /* Enable SigMotion */
  response = LSM6DS3_ACC_GYRO_W_SignifcantMotion(LSM6DS3_ACC_GYRO_SIGN_MOTION_EN_ENABLED);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Enable Embedded Functions */
  LSM6DS3_ACC_GYRO_W_FUNC_EN(LSM6DS3_ACC_GYRO_FUNC_EN_ENABLED);
}

/* Test SigMotion */
static void  Loop_Test_SigMotion(void)
{
  Number_Of_SigMot_events = 0;

  /* configure SigMotion */
  init_LSM6DS3_SigMotion();
  
#ifdef TEST_WITH_INTERRUPT
  RegisterInterrupt(LSM6DS3_ACC_GYRO_SigMotion_Callback);

  while(1) {
    /* Event will be handled in driver callback */
  }
#else
  LSM6DS3_ACC_GYRO_SIGN_MOT_EV_STATUS_t SigMotStatus;

  /*
   * Handle the event using polling mode
   */
  while(1) {
    LSM6DS3_ACC_GYRO_R_SIGN_MOT_EV_STATUS(&SigMotStatus);
    if (SigMotStatus == LSM6DS3_ACC_GYRO_SIGN_MOT_EV_STATUS_DETECTED) {
      Number_Of_SigMot_events++;

      /* handle event */
      SigMotStatus = LSM6DS3_ACC_GYRO_SIGN_MOT_EV_STATUS_NOT_DETECTED;
    }
  }
#endif
}

/*
 * DoubleTap test
 */

static u32_t DoubleTapCount = 0;

/*
 * Callback to handle the Double Tap event.
 * It must be registered to be called at interrupt time.
 */
void LSM6DS3_ACC_GYRO_DoubleTap_Callback(u8_t intID)
{
  LSM6DS3_ACC_GYRO_DOUBLE_TAP_EV_STATUS_t DoubleTapStatus;

  LSM6DS3_ACC_GYRO_R_DOUBLE_TAP_EV_STATUS(&DoubleTapStatus);
  if (DoubleTapStatus == LSM6DS3_ACC_GYRO_DOUBLE_TAP_EV_STATUS_DETECTED) {
    /* handle event */
    DoubleTapCount++;
    DoubleTapStatus = LSM6DS3_ACC_GYRO_DOUBLE_TAP_EV_STATUS_NOT_DETECTED;
  }
}

/* Init the Double Tap */
static void init_LSM6DS3_DoubleTap(void)
{
  /* Set ACC ODR  */
  response = LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_416Hz);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* Enable TAP x/y/z */
  LSM6DS3_ACC_GYRO_W_TAP_X_EN(LSM6DS3_ACC_GYRO_TAP_X_EN_ENABLED);
  LSM6DS3_ACC_GYRO_W_TAP_Y_EN(LSM6DS3_ACC_GYRO_TAP_Y_EN_ENABLED);
  LSM6DS3_ACC_GYRO_W_TAP_Z_EN(LSM6DS3_ACC_GYRO_TAP_Z_EN_ENABLED);

  /* Set the TAP threshold value */
  LSM6DS3_ACC_GYRO_W_TAP_THS(12);

  /* Route TAP ev on INT1 */
  LSM6DS3_ACC_GYRO_W_TapEvOnInt1(LSM6DS3_ACC_GYRO_INT1_TAP_ENABLED);

  /* Set interrupt durations */
  LSM6DS3_ACC_GYRO_W_QUIET_Duration(3);
  LSM6DS3_ACC_GYRO_W_SHOCK_Duration(3);
  LSM6DS3_ACC_GYRO_W_DUR(7);

  /* Enable Single/Double Tap */
  LSM6DS3_ACC_GYRO_W_SINGLE_DOUBLE_TAP_EV(LSM6DS3_ACC_GYRO_SINGLE_DOUBLE_TAP_SINGLE_TAP);

  /* Enable Embedded Functions */
  LSM6DS3_ACC_GYRO_W_FUNC_EN(LSM6DS3_ACC_GYRO_FUNC_EN_ENABLED);
}

/* Test Double Tap */
static void  Loop_Test_DoubleTap(void)
{
  /* configure Double Tap */
  init_LSM6DS3_DoubleTap();
  DoubleTapCount = 0;

#ifdef TEST_WITH_INTERRUPT
  RegisterInterrupt(LSM6DS3_ACC_GYRO_DoubleTap_Callback);

  while(1) {
    /* Event will be handled in driver callback */
  }
#else
  LSM6DS3_ACC_GYRO_DOUBLE_TAP_EV_STATUS_t DoubleTapStatus;

  /*
   * Handle the event using polling mode
   */
  while(1) {
    LSM6DS3_ACC_GYRO_R_DOUBLE_TAP_EV_STATUS(&DoubleTapStatus);
    if (DoubleTapStatus == LSM6DS3_ACC_GYRO_DOUBLE_TAP_EV_STATUS_DETECTED) {
      /* handle event */
      DoubleTapCount++;
      DoubleTapStatus = LSM6DS3_ACC_GYRO_DOUBLE_TAP_EV_STATUS_NOT_DETECTED;
    }
  }
#endif
}

/*
 * This test has been performed attaching a LIS3MDL magnetometer
 * to the I2C master bus provided by LSM6DS3 device.
 *
 * In this particular example the I2C master operations are triggered through
 * the internal Accelerometer dataready.
 */

/*
 * On this particular solution the SDO bit is set to '0', so the
 * LIS3MDL slave address is 0x38
 */
#define LIS3MDL_SLAVE_ADDR    0x38
#define LIS3MDL_WHO_AM_I_VAL  0x3D

#define LIS3MDL_WHO_AM_I      0x0F
#define LIS3MDL_CTRL_REG1     0x20
#define LIS3MDL_CTRL_REG2     0x21
#define LIS3MDL_CTRL_REG3     0x22
#define LIS3MDL_CTRL_REG4     0x23
#define LIS3MDL_CTRL_REG5     0x24

#define OUT_X_L               0x28
#define OUT_X_H               0x29
#define OUT_Y_L               0x2A
#define OUT_Y_H               0x2B
#define OUT_Z_L               0x2C
#define OUT_Z_H               0x2D

#define SENSITIVITY_LIS3MDL_16Ga     1711.0              //LSB/Ga

/* Init the sensorhub */
static void init_LSM6DS3_SensorHub(void)
{
  u8 who_am_i = 0x0;

  /* Enable ACC x/y/x axis (for triggering the operation) */
  LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_208Hz);

  /* read LIS3MDL who_am_i (0xF) */
  LSM6DS3_ACC_GYRO_SH0_ReadMem(LIS3MDL_SLAVE_ADDR, LIS3MDL_WHO_AM_I, &who_am_i, 1, 1);
  if (who_am_i != LIS3MDL_WHO_AM_I_VAL)
    while(1); //manage here comunication error

  /* write 0x7C in LIS3MDL ctrl_reg1 */
  /* ODR 80Hz - XY at ultra-high perf  */
  response = LSM6DS3_ACC_GYRO_SH0_WriteByte(LIS3MDL_SLAVE_ADDR, LIS3MDL_CTRL_REG1, 0x7C);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* write 0x60 in LIS3MDL ctrl_reg2 */
  /* Set FS to 16 Gauss  */
  response = LSM6DS3_ACC_GYRO_SH0_WriteByte(LIS3MDL_SLAVE_ADDR, LIS3MDL_CTRL_REG2, 0x60);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* write 0x0C in LIS3MDL ctrl_reg4 */
  /* Set Z at ultra-high perf */
  response = LSM6DS3_ACC_GYRO_SH0_WriteByte(LIS3MDL_SLAVE_ADDR, LIS3MDL_CTRL_REG4, 0x0C);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* write 0x00 in LIS3MDL ctrl_reg3 */
  /* continuos conversion mode */
  response = LSM6DS3_ACC_GYRO_SH0_WriteByte(LIS3MDL_SLAVE_ADDR, LIS3MDL_CTRL_REG3, 0x00);
  if(response==MEMS_ERROR) while(1); //manage here comunication error

  /* write 0x40 in LIS3MDL ctrl_reg5 */
  /* set BDU */
  response = LSM6DS3_ACC_GYRO_SH0_WriteByte(LIS3MDL_SLAVE_ADDR, LIS3MDL_CTRL_REG5, 0x40);
  if(response==MEMS_ERROR) while(1); //manage here comunication error
}

/* Init the sensorhub using I2C PassThrough mode */
static void init_LSM6DS3_PT_SensorHub(void)
{
  u8 who_am_i = 0x0, Data;

  /* Enable ACC x/y/x axis (for triggering the operation) */
  LSM6DS3_ACC_GYRO_W_ODR_XL(LSM6DS3_ACC_GYRO_ODR_XL_208Hz);

  /* Enable Passthru mode */
  LSM6DS3_ACC_GYRO_W_PASS_THRU_MODE(LSM6DS3_ACC_GYRO_PASS_THRU_MODE_ENABLED);

  /* read LIS3MDL who_am_i (0xF) */
  I2Cx_Read(&who_am_i, LIS3MDL_SLAVE_ADDR, LIS3MDL_WHO_AM_I, 1);
  if (who_am_i != LIS3MDL_WHO_AM_I_VAL)
    while(1); //manage here comunication error

  /* write 0x7C in LIS3MDL ctrl_reg1 */
  /* ODR 80Hz - XY at ultra-high perf  */
  Data = 0x7C;
  I2Cx_Write(&Data, LIS3MDL_SLAVE_ADDR,  LIS3MDL_CTRL_REG1, 1);

  /* write 0x60 in LIS3MDL ctrl_reg2 */
  /* Set FS to 16 Gauss  */
  Data = 0x60;
  I2Cx_Write(&Data, LIS3MDL_SLAVE_ADDR,  LIS3MDL_CTRL_REG2, 1);

  /* write 0x0C in LIS3MDL ctrl_reg4 */
  /* Set Z at ultra-high perf */
  Data = 0x0C;
  I2Cx_Write(&Data, LIS3MDL_SLAVE_ADDR,  LIS3MDL_CTRL_REG4, 1);

  /* write 0x00 in LIS3MDL ctrl_reg3 */
  /* continuos conversion mode */
  Data = 0x00;
  I2Cx_Write(&Data, LIS3MDL_SLAVE_ADDR,  LIS3MDL_CTRL_REG3, 1);

  /* write 0x40 in LIS3MDL ctrl_reg5 */
  /* set BDU */
  Data = 0x40;
  I2Cx_Write(&Data, LIS3MDL_SLAVE_ADDR,  LIS3MDL_CTRL_REG5, 1);

  /* Disable Passthru mode */
  LSM6DS3_ACC_GYRO_W_PASS_THRU_MODE(LSM6DS3_ACC_GYRO_PASS_THRU_MODE_DISABLED);
}

/* Test the sensorhub */
static void  Loop_Test_SensorHub(void)
{
  u8_t si_identity_mat[9] = {8,0,0,0,8,0,0,0,8};

  /* configure external sensor */
  if (LSM6DS3_ACC_GYRO_Device_Rev == 1)
    init_LSM6DS3_PT_SensorHub();
  else
    init_LSM6DS3_SensorHub();

  /* Program the six Soft Iron Matrix coefficients */
  LSM6DS3_ACC_GYRO_SH_init_SI_Matrix(si_identity_mat);

  /* program to .... */
  LSM6DS3_ACC_GYRO_SH0_Program(LIS3MDL_SLAVE_ADDR, OUT_X_L, 6);

  while(1) {
    /* Read the result */
    LSM6DS3_ACC_GYRO_ReadMem(LSM6DS3_ACC_GYRO_SENSORHUB1_REG, magneticField.u8bit, 6);

    magneticFieldGauss[0]=magneticField.i16bit[0]*1000/SENSITIVITY_LIS3MDL_16Ga;
    magneticFieldGauss[1]=magneticField.i16bit[1]*1000/SENSITIVITY_LIS3MDL_16Ga;
    magneticFieldGauss[2]=magneticField.i16bit[2]*1000/SENSITIVITY_LIS3MDL_16Ga;
  }
}

/*******************************************************************************
* Function Name  : main.
* Description    : Simple LIS3MDL Example.
* Input          : None.
* Output         : None.
* Return         : None.
*******************************************************************************/
int main(void)
{ 
  u8 who_am_i = 0x0;

  InitHardware();
  I2C_MEMS_Init();

  /* Read WHO_AM_I  and check if device is really the LSM6DS3 */
  LSM6DS3_ACC_GYRO_R_WHO_AM_I(&who_am_i);
  if (who_am_i != LSM6DS3_ACC_GYRO_WHO_AM_I)
    while(1); //manage here comunication error

  /* Soft Reset the LSM6DS3 device */
  LSM6DS3_ACC_GYRO_W_SW_RESET(LSM6DS3_ACC_GYRO_SW_RESET_RESET_DEVICE);

  /* Read device revision */
  LSM6DS3_ACC_GYRO_Device_Rev = LSM6DS3_ACC_GYRO_Check_Dev_revision();

  /* If Device is revAB write in RAM the workaround */
  if (LSM6DS3_ACC_GYRO_Device_Rev == 0) {
    /* Initilize the RAM with the program code */
    if (LSM6DS3_ACC_GYRO_init_RAM(ram_code) != MEMS_SUCCESS)
      while(1); //manage here comunication error
  }

  /*
   * Test routines.
   * Uncomment the one you need to exec.
   */

  /* Test sensor samples acquisition */
  Loop_Test_Sample_Aquisition();

  /* Test Pedometer */
  //Loop_Test_Pedometer();
  
  /* Test Wakup */
  //Loop_Test_Wakeup();

  /* Test Tilt */
  //Loop_Test_Tilt();

  /* Test SigMotion */
  //Loop_Test_SigMotion();

  /* Test Double Tap */
  //Loop_Test_DoubleTap();

  /* Test Sensorhub */
  //Loop_Test_SensorHub();

} // end main


/******************* (C) COPYRIGHT 2014 STMicroelectronics *****END OF FILE****/
